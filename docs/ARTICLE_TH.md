# ‡∏™‡∏£‡πâ‡∏≤‡∏á LLM Proxy Server ‡∏£‡∏∞‡∏î‡∏±‡∏ö Production ‡∏î‡πâ‡∏ß‡∏¢ Go (Golang)

‡πÉ‡∏ô‡∏¢‡∏∏‡∏Ñ‡∏ó‡∏µ‡πà AI ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏£‡∏≠‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ API Key ‡∏Ç‡∏≠‡∏á LLM (‡πÄ‡∏ä‡πà‡∏ô OpenAI, Azure, Claude) ‡∏°‡∏±‡∏Å‡∏à‡∏∞‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏£‡∏∑‡πâ‡∏≠‡∏£‡∏±‡∏á ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô Key ‡∏´‡∏•‡∏∏‡∏î, ‡∏Ñ‡∏∏‡∏°‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà ‡∏´‡∏£‡∏∑‡∏≠ Rate Limit ‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡πà‡∏°

‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ú‡∏°‡∏à‡∏∞‡∏û‡∏≤‡∏°‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á **LLM Proxy Server** ‡∏î‡πâ‡∏ß‡∏¢‡∏†‡∏≤‡∏©‡∏≤ **Go** ‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏ö‡πá‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏£‡∏∞‡∏î‡∏±‡∏ö Enterprise ‡∏≠‡∏¢‡πà‡∏≤‡∏á **Virtual Keys**, **Rate Limiting** ‡πÅ‡∏•‡∏∞‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Database ‡∏´‡∏•‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢ ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ô‡∏µ‡πâ Deploy ‡∏á‡πà‡∏≤‡∏¢‡πÜ ‡∏î‡πâ‡∏ß‡∏¢ Docker ‡∏Ñ‡∏£‡∏±‡∏ö

---

## üéØ ‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ã‡∏õ‡∏ï‡πå‡∏´‡∏•‡∏±‡∏Å (Concept)

‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ "‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏≤‡∏á" (Proxy) ‡∏ó‡∏µ‡πà‡∏Ñ‡∏±‡πà‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á User/App ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ ‡∏Å‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ (Provider)
**‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ó‡∏≥:**
1.  **Connection Management**: ‡πÄ‡∏Å‡πá‡∏ö Real API Key ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà Server ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ù‡∏±‡∏á‡πÉ‡∏ô Code
2.  **Virtual Keys**: ‡∏™‡∏£‡πâ‡∏≤‡∏á Key ‡∏õ‡∏•‡∏≠‡∏° (Virtual) ‡πÅ‡∏à‡∏Å‡πÉ‡∏´‡πâ‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡πÉ‡∏ä‡πâ ‡πÇ‡∏î‡∏¢ Key ‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ú‡∏π‡∏Å‡∏Å‡∏±‡∏ö Connection ‡∏à‡∏£‡∏¥‡∏á
3.  **Rate Limiting**: ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤ Virtual Key ‡∏ô‡∏µ‡πâ‡∏¢‡∏¥‡∏á‡πÑ‡∏î‡πâ‡∏Å‡∏µ‡πà‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ (TPS) ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ Token ‡πÑ‡∏î‡πâ‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà
4.  **Flexible Database**: ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏°‡∏î‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏à‡∏∞ SQLite (‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏à‡∏ö), Postgres ‡∏´‡∏£‡∏∑‡∏≠ MongoDB

## üõ†Ô∏è ‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ (Tech Stack)

‡πÄ‡∏£‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **Go** ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏£‡πá‡∏ß‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Concurrency ‡πÑ‡∏î‡πâ‡πÄ‡∏ó‡∏û‡∏°‡∏≤‡∏Å ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏á‡∏≤‡∏ô Proxy ‡∏™‡∏∏‡∏î‡πÜ
-   **Web Framework**: [Gin](https://github.com/gin-gonic/gin) (‡πÄ‡∏£‡πá‡∏ß‡πÅ‡∏•‡∏∞‡∏ô‡∏¥‡∏¢‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î)
-   **CLI Tools**: [Cobra](https://github.com/spf13/cobra) (‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö kubectl)
-   **ORM**: [GORM](https://gorm.io/) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö SQL ‡πÅ‡∏•‡∏∞ Official Driver ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö MongoDB
-   **Rate Limit**: ‡πÉ‡∏ä‡πâ Algorithm ‡πÅ‡∏ö‡∏ö Token Bucket ‡∏ú‡πà‡∏≤‡∏ô `golang.org/x/time/rate`

## üí° ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö (Architecture)

### 1. Database Interface ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÄ‡∏≠‡∏≤‡∏≠‡∏¢‡∏π‡πà
‡πÄ‡∏£‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Interface ‡∏Å‡∏•‡∏≤‡∏á‡∏ä‡∏∑‡πà‡∏≠ `DB` ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏™‡∏•‡∏±‡∏ö Database ‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡πÜ ‡πÅ‡∏Ñ‡πà‡πÅ‡∏Å‡πâ Config ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ Code ‡∏´‡∏•‡∏±‡∏Å

```go
type DB interface {
    SaveConnection(...) error
    GetConnection(...) ...
}
```

### 2. Rate Limiting ‡πÅ‡∏ö‡∏ö 2 ‡∏°‡∏¥‡∏ï‡∏¥
‡∏õ‡∏Å‡∏ï‡∏¥ Proxy ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡∏à‡∏∞‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÅ‡∏Ñ‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Request (TPS) ‡πÅ‡∏ï‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô AI ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà **Token** ‡∏Ñ‡∏£‡∏±‡∏ö ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡πÄ‡∏•‡∏¢‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á 2 ‡πÅ‡∏Å‡∏ô:

```go
type Limiter struct {
    tpsLimiter   *rate.Limiter // ‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà‡∏¢‡∏¥‡∏á API
    tokenLimiter *rate.Limiter // ‡∏Ñ‡∏∏‡∏°‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì Token
}
```
‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏ï‡πà‡∏≠‡πÉ‡∏´‡πâ user ‡∏¢‡∏¥‡∏á‡∏°‡∏≤‡∏ä‡πâ‡∏≤‡πÜ ‡πÅ‡∏ï‡πà‡∏™‡πà‡∏á Context ‡∏¢‡∏≤‡∏ß‡πÜ ‡∏à‡∏ô‡∏á‡∏ö‡∏´‡∏°‡∏î ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏±‡∏ö

### 3. Proxy Logic
‡∏ï‡∏±‡∏ß Server ‡∏à‡∏∞‡∏£‡∏±‡∏ö Request ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤ -> ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Virtual Key -> ‡πÄ‡∏ä‡πá‡∏Ñ Rate Limit -> ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠ (Forward) ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Provider ‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡πà User ‡∏ù‡∏±‡πà‡∏á Client ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡πÄ‡∏•‡∏¢‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ Key ‡∏≠‡∏∞‡πÑ‡∏£

## üöÄ ‡∏Å‡∏≤‡∏£ Deploy ‡∏î‡πâ‡∏ß‡∏¢ Docker

‡πÄ‡∏£‡∏≤‡πÉ‡∏ä‡πâ **Multi-Stage Build** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏µ‡∏î‡πÉ‡∏´‡πâ Image ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÅ‡∏Ñ‡πà Binary + Alpine)

```dockerfile
# Stage 1: Build
FROM golang:1.24-alpine AS builder
# ... compile ...

# Stage 2: Run
FROM alpine:latest
COPY --from=builder /app/llm-proxy .
ENTRYPOINT ["./llm-proxy"]
```
‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Ñ‡∏∑‡∏≠ Image ‡∏Ç‡∏ô‡∏≤‡∏î‡∏à‡∏¥‡πã‡∏ß (~20MB) ‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏≤‡πÅ‡∏•‡∏∞‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ Source Code ‡∏ï‡∏¥‡∏î‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢

## üïπÔ∏è ‡∏ß‡∏¥‡∏ò‡∏µ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô (How to run)

‡πÅ‡∏Ñ‡πà Clone code ‡πÅ‡∏•‡πâ‡∏ß‡∏™‡∏±‡πà‡∏á Docker Compose:

```bash
docker compose up -d
```

‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏° Key ‡∏Ç‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ (‡πÄ‡∏Å‡πá‡∏ö‡∏•‡∏±‡∏ö‡πÜ ‡∏ó‡∏µ‡πà Server):
```bash
./llm-proxy connection add --name "OpenAI-Prod" --provider "openai" --endpoint "..." --api-key "sk-..."
```

‡πÅ‡∏•‡πâ‡∏ß‡∏™‡∏£‡πâ‡∏≤‡∏á Virtual Key ‡πÉ‡∏´‡πâ junior developer ‡πÉ‡∏ô‡∏ó‡∏µ‡∏°:
```bash
./llm-proxy vkey add --name "Junior-Dev" --conn-id "..." --tps 2 --tokens 1000
```

‡∏à‡∏ö! ‡∏ô‡πâ‡∏≠‡∏á‡∏Ñ‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡πá‡πÄ‡∏≠‡∏≤ Virtual Key ‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô Code ‡πÄ‡∏Ç‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏¢‡∏¥‡∏á‡∏°‡∏≤‡∏ó‡∏µ‡πà `http://localhost:8132` ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡∏ñ‡πâ‡∏≤‡∏¢‡∏¥‡∏á‡∏£‡∏±‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πá‡∏à‡∏∞ Block ‡πÉ‡∏´‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏´‡∏≤‡∏¢‡∏´‡πà‡∏ß‡∏á

## ‡∏ö‡∏ó‡∏™‡∏£‡∏∏‡∏õ

‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏û‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á Go ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ System Tools ‡∏ó‡∏µ‡πà‡∏ó‡∏±‡πâ‡∏á‡πÄ‡∏£‡πá‡∏ß‡πÅ‡∏•‡∏∞Maintain ‡∏á‡πà‡∏≤‡∏¢ ‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° Layer ‡∏Ç‡∏≠‡∏á Virtual Key ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ AI Infrastructure ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏∑‡∏≠‡∏≠‡∏≤‡∏ä‡∏µ‡∏û ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° Cost ‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á‡∏Ñ‡∏£‡∏±‡∏ö

---
*Source code ‡∏â‡∏ö‡∏±‡∏ö‡πÄ‡∏ï‡πá‡∏°‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô Repository ‡∏ô‡∏≥‡πÑ‡∏õ‡∏ï‡πà‡∏≠‡∏¢‡∏≠‡∏î‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö*
